# 說明
你是一個專業的量化交易員，同時又是一個頂尖的軟體工程師，我有一個資料檔案處理的問題需要你幫忙處理，目前在 scripts/batch_process.py有可以參考的程式碼，但目前他解碼的方式好像是錯的。
你需要參考這份文件，再重新寫一次解碼的程式碼，在測試的過程中你可以先使用OTCQuote.20251031來測試確認是否有解對，那我想要你解的是有出現在 data/processed_data/lup_ma20_filtered.parquet的清單，那邊清單內的股票是當日漲停的股票，那假設我們要解2025-10-31，那你就需要解在2025-10-30有出現在lup_ma20_filtered.parquet的股票清單，還有出現在2025-10-31的股票清單。

```
OTC/TSEQuote.{Y-M-D} 資料內部細節。
1. 成交格式: Trade,股票代碼,成交時間,試撮旗標,成交價,成交單量,成交總量,序號
   試撮旗標: 0：一般揭示 1：試算揭示 	
   成交價: 4位小數, 333500 實際成交價 -> 33.35
   EX: Trade,2355  ,131219825776,0,333500,1,1530,1234

2. 五檔格式: Depth,股票代碼,報價時間,
			BID:委買檔數,第1檔價格*數量,第2檔價格*數量,第3檔價格*數量,第4檔價格*數量,第5檔價格*數量,
            ASK:委賣檔數,第1檔價格*數量,第2檔價格*數量,第3檔價格*數量,第4檔價格*數量,第5檔價格*數量
			,序號
   EX: Depth,2355  ,131219825776,BID:5,333000*27,332500*5,332000*32,331500*35,331000*62,ASK:5,333500*17,334000*5,334500*13,335000*44,335500*14,1234


3. 內部範例
Trade,8043  ,84127027089,1,492000,17,0
Depth,8043  ,84127027089,BID:5,486000*3,485500*10,485000*25,483000*1,479500*1,ASK:5,492000*1,493000*1,494000*6,495000*2,496000*1
Trade,6223  ,84127027089,1,20300000,4,0
Depth,6223  ,84127027089,BID:5,20200000*1,20150000*1,20050000*1,20000000*2,19800000*3,ASK:5,20300000*2,20400000*2,20450000*3,20500000*5,20600000*2
Trade,00725B,84127027089,1,356700,6,0
Depth,00725B,84127027089,BID:5,356700*1,356500*4,356300*1,356000*1,355600*5,ASK:5,356800*1,357200*1,358000*2,358100*8,358300*2
Depth,5904  ,84127027089,BID:5,4645000*1,4630000*1,4620000*1,4605000*1,4530000*1,ASK:5,4660000*1,4685000*5,4690000*17,4700000*1,4710000*2
Depth,4728  ,84127227802,BID:5,3870000*1,3830000*1,3810000*1,3650000*1,3520000*1,ASK:4,3940000*1,4000000*1,4055000*1,4100000*1
Depth,5245  ,84127227802,BID:5,223000*2,222500*1,221500*10,220000*2,218500*1,ASK:5,235000*1,238000*1,239500*2,244000*2,245000*1
Trade,5324  ,84127227802,1,118000,100,0
Depth,5324  ,84127227802,BID:5,116500*16,113500*18,113000*14,110500*12,110000*6,ASK:5,118000*20,119500*3,120000*4,120500*1,121000*21
Trade,1785  ,84127428534,1,575000,198,0
Depth,1785  ,84127428534,BID:5,575000*60,574000*20,573000*2,572000*19,571000*2,ASK:5,589000*5,590000*5,594000*1,595000*1,596000*1
Trade,8176  ,84127428534,1,123000,80,0
Depth,8176  ,84127428534,BID:5,123000*553,122500*380,122000*18,120500*12,116500*16,ASK:0
Trade,6499  ,84127428534,1,1115000,58,0
Depth,6499  ,84127428534,BID:5,1100000*1,1080000*1,1065000*2,1060000*2,1045000*1,ASK:5,1120000*9,1125000*4,1130000*6,1140000*5,1145000*2
Trade,8040  ,84127428534,1,503000,1,0
Depth,8040  ,84127428534,BID:5,501000*1,500000*1,493000*1,492000*1,491000*1,ASK:5,523000*1,535000*1,536000*1,550000*3,553000*1
Trade,6220  ,84127629207,1,217000,3,0
Depth,6220  ,84127629207,BID:5,212000*1,209500*3,209000*55,208500*2,208000*10,ASK:5,217000*1,218000*2,218500*1,219000*2,219500*2
Trade,8086  ,84127629207,1,1050000,102,0
Depth,8086  ,84127629207,BID:5,1050000*6,1045000*1,1040000*7,1035000*7,1030000*24,ASK:5,1055000*1,1060000*11,1070000*1,1075000*1,1080000*1
Trade,6761  ,84127629207,1,1485000,14,0
Depth,6761  ,84127629207,BID:5,1470000*1,1465000*1,1435000*2,1430000*1,1420000*2,ASK:5,1485000*1,1490000*3,1500000*8,1510000*4,1515000*2
Trade,6187  ,84127629207,1,3655000,21,0
Depth,6187  ,84127629207,BID:5,3580000*3,3575000*1,3570000*1,3560000*5,3550000*8,ASK:5,3660000*1,3665000*1,3670000*4,3675000*1,3680000*7
Depth,3213  ,84127829279,BID:5,1055000*2,1050000*5,1045000*10,1040000*11,1035000*2,ASK:5,1070000*4,1075000*5,1080000*4,1085000*19,1090000*9
Depth,2751  ,84127829279,BID:5,664000*1,661000*1,658000*2,657000*1,656000*1,ASK:4,699000*1,714000*1,732000*12,743000*3
Trade,8390  ,84128029627,1,642000,1,0
Depth,8390  ,84128029627,BID:5,641000*5,640000*4,639000*1,638000*1,637000*3,ASK:5,648000*1,649000*1,650000*1,652000*1,654000*1
Trade,2745  ,84128029627,1,1100000,1,0
Depth,2745  ,84128029627,BID:5,1100000*2,1090000*5,1085000*4,1080000*5,1075000*8,ASK:5,1120000*5,1125000*2,1130000*1,1135000*3,1150000*2
Depth,6151  ,84128029627,BID:5,285000*10,282000*2,279000*3,278000*2,277000*3,ASK:5,286500*1,287000*4,288000*6,294500*1,298000*1
Trade,6218  ,84128230327,1,211500,56,0
Depth,6218  ,84128230327,BID:5,211500*28,211000*1,210500*1,210000*1,209500*1,ASK:0
Trade,3284  ,84128230327,1,216500,5,0
Depth,3284  ,84128230327,BID:5,216500*5,213500*1,213000*4,212500*6,212000*1,ASK:5,223500*2,224000*1,225000*1,228000*3,229500*2
Trade,00937B,84128230327,1,151700,678,0
Depth,00937B,84128230327,BID:5,151600*377,151500*235,151400*246,151300*235,151200*268,ASK:5,151700*216,151800*541,151900*499,152000*7,152200*30
Trade,6217  ,84128431028,1,563000,171,0
Depth,6217  ,84128431028,BID:5,545000*5,540000*1,539000*1,538000*1,536000*1,ASK:5,563000*15,564000*19,565000*22,566000*2,567000*14
Depth,2070  ,84128431028,BID:5,404500*1,390000*1,380000*1,379500*1,370000*1,ASK:5,424500*3,425000*1,426000*1,443000*2,445000*2
Trade,3276  ,84128431028,1,178500,253,0
Depth,3276  ,84128431028,BID:5,178500*1321,178000*1,172000*4,171000*21,168000*8,ASK:0
Trade,00933B,84128431028,1,163000,6,0
Depth,00933B,84128431028,BID:5,162900*1,162800*6,162700*17,162600*52,162500*20,ASK:5,163000*24,163100*33,163200*10,163300*43,163500*2
Trade,6547  ,84128431028,1,322500,124,0
Depth,6547  ,84128431028,BID:4,320000*13,316500*1,316000*3,315500*31,ASK:5,350500*6,351000*1,354500*2,355000*6,359000*2
Trade,3689  ,84128631747,1,1000000,6,0  
```